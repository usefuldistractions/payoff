"use strict";!function(e){var r=0<arguments.length&&void 0!==e?e:window;return void 0!==r.define?r.define("Payoff",t):r.Payoff=t;function t(e){var z=this,A=[],B={},r=0;return Object.defineProperties(this,{reconcile:{value:function(){var e=B,r=e.startMonth,t=e.startYear,n=e.duration,a=e.amount,o=e.rate/12,i=1+o,f=Math.pow(i,n),u=a*(o*f/(f-1));u=G(u,2);for(var c=0,d=0,p=0,h=a,y=[],m=0;m<=n;m++){for(var l=new Date(t,r+m,1),v=l.getFullYear(),s=v.toString(),P=l.getMonth()+1,w=C(P,2),g=C(l.getDate(),2),b=0,M=0;M<A.length;M++){var E=A[M],Y=E.year,N=E.month,j=E.endYear,D=E.endMonth,k=E.recurring,S=!1;Y===v&&N===P?S=!0:k&&(Y<v||v===Y&&N<=P)&&("number"==typeof D&&"number"==typeof j?(v<j||v===j&&P<=D)&&(S=!0):S=!0),S&&(b+=E.amount)}var q=G(h*o,2),x=G(u-q+b,2);(h=G(h-x,2))<0&&(x+=h,h=0);var F=q+x;if(y.push({paid:F,year:v,month:P,principal:h,interestPaid:q,principalPaid:x,date:"".concat(s,"-").concat(w,"-").concat(g)}),c+=F,d+=q,p+=x,h<=0)break}var O=y[y.length-1];z.amount=G(a,2),z.interestPaid=G(d,2),z.monthlyPayment=G(u,2),z.paid=G(c,2),z.payoffDate=O.date,z.payoffMonth=O.month,z.payoffYear=O.year,z.principalPaid=G(p,2),z.startYear=t,z.startMonth=r,z.table=y}},update:{value:function(e){if("object"!=typeof B)throw new Error("setup object required");return B=e,z.reconcile()}},addPayment:{value:function(e){if("number"!=typeof e.amount)throw new Error("Payoff.addPayment(): No amount specified");if("number"!=typeof e.month)throw new Error("Payoff.addPayment(): No month specified");if("number"!=typeof e.year)throw new Error("Payoff.addPayment(): No year specified");return e.index=r++,!0!==e.recurring&&(e.recurring=!1),A.push(e),z.reconcile()}},removePayment:{value:function(e){if("number"!=typeof e.id)throw new Error("Payoff.removePayment(): No id specified");for(var r=0;r<A.length;r++){var t=A[r];if(t.id==t.id){A.splice(r,1);break}}return z.reconcile()}}}),this.update(e)}function C(e,r){for(var t=Math.floor(e).toString(),n=r-t.length,a="",o=0;o<n;o++)a+="0";return"".concat(a).concat(t)}function G(e,r){var t=Math.pow(10,r),n=e*t;return Math.round(n)/t}}(void 0);