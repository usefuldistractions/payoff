"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(){return"function"==typeof define?define("Payoff",t):("object"===("undefined"==typeof global?"undefined":_typeof(global))?global:window).Payoff=t;function t(t){function n(){for(var t=x.startMonth,e=x.startYear,r=x.duration,n=x.amount,o=x.rate/12,a=1+o,f=Math.pow(a,r),i=A(i=n*(o*f/(f-1)),2),u=0,y=0,p=0,c=n,d=[],m=0;m<=r;m++){for(var h=new Date(e,t+m,1),l=h.getFullYear(),s=l.toString(),b=h.getMonth()+1,P=z(b,2),g=z(h.getDate(),2),v=0,w=0;w<F.length;w++){var M=F[w],S=M.year,N=M.month,E=M.endYear,Y=M.endMonth,j=M.recurring,D=S===l&&N===b||j&&(S<l||l===S&&N<=b)&&("number"!=typeof Y||"number"!=typeof E||l<E||l===E&&b<=Y)?!0:!1;D&&(v+=M.amount)}var O=A(c*o,2),_=A(i-O+v,2);(c=A(c-_,2))<0&&(_+=c,c=0);var k=O+_;if(d.push({paid:k,year:l,month:b,principal:c,interestPaid:O,principalPaid:_,date:"".concat(s,"-").concat(P,"-").concat(g)}),u+=k,y+=O,p+=_,c<=0)break}var J=d[d.length-1];q.amount=A(n,2),q.interestPaid=A(y,2),q.monthlyPayment=A(i,2),q.paid=A(u,2),q.payoffDate=J.date,q.payoffMonth=J.month,q.payoffYear=J.year,q.principalPaid=A(p,2),q.startYear=e,q.startMonth=t,q.table=d}var q=this,F=[],x={},e=0;return Object.defineProperties(this,{update:{value:function(t){if("object"!=typeof x)throw new Error("setup object required");return x=t,n()}},addPayment:{value:function(t){if("number"!=typeof t.amount)throw new Error("Payoff.addPayment(): No amount specified");if("number"!=typeof t.month)throw new Error("Payoff.addPayment(): No month specified");if("number"!=typeof t.year)throw new Error("Payoff.addPayment(): No year specified");return t.id=e++,!0!==t.recurring&&(t.recurring=!1),F.push(t),n()}},removePayment:{value:function(t){if("number"!=typeof t.id)throw new Error("Payoff.removePayment(): No id specified");for(var e=0;e<F.length;e++){var r=F[e];if(t.id===r.id){F.splice(e,1);break}}return n()}},payments:{get:function(){var t=JSON.stringify(F);return JSON.parse(t)}}}),this.update(t)}function z(t,e){for(var r=Math.floor(t).toString(),n=e-r.length,o="",a=0;a<n;a++)o+="0";return"".concat(o).concat(r)}function A(t,e){var r=Math.pow(10,e),n=t*r;return Math.round(n)/r}}();